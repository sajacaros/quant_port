# Chapter3 데이터 분석 배워 보기
## 3.1 시리즈
![series](https://github.com/sajacaros/quant_port/raw/main/image/eda/series.png)
### 3.1.1 시리즈 만들기
```
import pandas as pd
series = pd.Series({'a':1, 'b':2, 'c':3})
series = pd.Series([1,2,3], index=['a','b','c'])
```
### 3.1.2 원소 선택하기
``` 
capital = pd.Series({'Korea': 'Seoul',
                     'Japan': 'Tokyo',
                     'China': 'Beijing',
                     'India': 'New Delhi',
                     'Taiwan': 'Taipei',
                     'Singapore': 'Singapore'
                     })
capital['Korea']
capital[0]
capital[['Korea', 'Japan']]
capital[[0,1]]
capital[0:3]
```
### 3.1.3 시리즈 연산하기
``` 
series_1 = pd.Series([1,2,3])
series_2 = pd.Series([4,5,6])
series_1 + series_2
series_1 * 2
```
## 3.2 데이터프레임
![dataframe](https://github.com/sajacaros/quant_port/raw/main/image/eda/dataframe.png)
### 3.2.1 데이터프레임 만들기와 수정하기
* 데이터프레임 만들기
``` 
df = pd.DataFrame({'col1': [1,2,3], 'col2': [4,5,6], 'col3': [7,8,9]})
df = pd.DataFrame(
    [[1,2,3], [4,5,6], [7,8,9]], 
    columns=['col1','col2','col3']
)
df = pd.DataFrame(
    [[1,2,3], [4,5,6], [7,8,9]], 
    columns=['col1','col2','col3'], 
    index=['i1','i2','i3']
)
df = pd.DataFrame([[1,2,3], [4,5,6], [7,8,9]])
df.columns=['col1','col2','col3'], 
df.index=['i1','i2','i3']
```
* 데이터프레임 제거하기
``` 
df = pd.DataFrame(
    [[1,2,3], [4,5,6], [7,8,9]], 
    columns=['col1','col2','col3'], 
    index=['i1','i2','i3']
)
df.drop('i3', axis=0, inplace=True)
df.drop('col2', axis=1, inplace=True)
```
### 3.2.2 열과 행 선택하기
* 열 선택하기
``` 
df = pd.DataFrame(
    [[1,2,3], [4,5,6], [7,8,9]], 
    columns=['col1','col2','col3'], 
    index=['i1','i2','i3']
)
df['col1'] # series
df[['col1']] # dataframe
```
* 행 선택하기
``` 
df.loc['i1']
df.loc[['i1']]
df.iloc[0]
df.iloc[[0]]
df.loc['i1':'i3']
df.iloc[0:2] 
```
* 행과 열 선택하기
  * DataFrame.loc['행 인덱스', '열 이름'] # 슬라이스 범위 끝 포함
  * DataFrame.iloc[행 위치, 열 위치] # 슬라이스 범위 끝 제외
``` 
df.loc['i1', 'col1']
df.iloc[0, 0]
df.loc[['i1', 'i3'], ['col1', 'col3']]
df.iloc[[0, 2], [0, 2]]
df.loc['i1':'i3', 'col1':'col3']
df.iloc[0:2, 0:2]
```
## 3.3 데이터 불러오기 및 저장하기
``` 
import pandas as pd

data_csv = pd.read_csv('https://raw.githubusercontent.com/hyunyulhenry/quant_py/main/kospi.csv')
data_csv.to_csv('data.csv')

data_excel = pd.read_excel('https://github.com/hyunyulhenry/quant_py/raw/main/kospi.xlsx', sheet_name='kospi')
data_excel.to_excel('data.xlsx')
```
## 3.4 데이터 요약 정보 및 통계값 살펴보기
* 맨 위/아래 살펴보기
``` 
import seaborn as sns
df = sns.load_dataset('titanic')
df.head(5)
df.tail(5)
```
* 데이터프레임 크기 확인
``` 
df.shape 
```
* 데이터프레임 기본 정보
``` 
df.info()
```
* 각 열의 고유값 개수
``` 
df['sex'].value_counts()
df[['sex','survived']].value_counts()
df[['sex','survived']].value_counts(normalize=True)
df[['sex','survived']].value_counts(normalize=True).sort_index()
```
* 산술 평균
``` 
df['survived'].mean()
df[['survived', 'age']].mean()
```
* 최소값/최대값
``` 
df['fare'].min()
df['fare'].max()
df['fare'].mean()
df['fare'].median() # 중위수, 자료를 크기 순으로 배열했을 때 제일 가운데에 위치하는 값
```
## 3.5 결측치 처리하기
### 3.5.1 결측치 삭제하기
* dropna() 메서드
``` 
df.dropna() # NaN이 있는 행 삭제
df.dropna(subset=['age'], axis=0) # age 가 NaN인 행 삭제
df.dropna(axis=1) # NaN이 있는 열 삭제
df.dropna(axis=1, thresh=300) # NaN이 300개 이상인 열만 삭제
```
### 3.5.2 결측치 대체하기
* 평균 나이로 대체
``` 
df2 = df.copy()
df2['age'].fillna(df2['age'].mean(), inplace=True)
```
* 직전/후 행의 값으로 대체
``` 
df2['deck_ffill'] = df2['deck'].fillna(method='ffill')
df2['deck_bfill'] = df2['deck'].fillna(method='bfill')
```
## 3.6 인덱스 다루기
* mpg 데이터셋 로드
``` 
import seaborn as sns
df = sns.load_dataset('mpg')
df.head()
```
* 특정 열을 index로 설정하기
``` 
df.set_index('name', inplace=True)
df.head()
```
* 인덱스 기반으로 정렬하기
``` 
df.sort_index(inplace=True)
df.head()
df.sort_index(inplace=True, ascending=False)
df.head()
```
* 인덱스 초기화
``` 
df.reset_index(inplace=True)
df.head()
```
## 3.7 필터링
* 시리즈나 데이터프레임에서 조건을 만족하는 원소만 추출
### 3.7.1 불리언 인덱싱
* 특정 열의 값 확인
``` 
df['cylinders'].unique()
```
* 특정 조건으로 필터링 하기
``` 
filter_bool = (df['cylinders'] == 4)
filter_bool.head()
df.loc[filter_bool]

filter_bool2 = (df['cylinders'] == 4) & (df['horsepower'] >= 100)
df.loc[filter_bool2, ['cylinders', 'horsepower', 'name']]
```
### 3.7.2 isin() 메서드
* 특정 조건으로 필터링 하기
``` 
filter_bool3 = (df['name'] == 'ford maverick') | (df['name'] == 'ford mustang ii') | (df['name'] == 'chevrolet impala')
df.loc[filter_bool3]
```
* isin() 메서드 이용하기
``` 
filter_isin = df['name'].isin(['ford maverick', 'ford mustang ii', 'chevrolet impala'])
df.loc[filter_isin]
```
## 3.8 새로운 열 만들기
## 3.9 데이터프레임 합치기
### 3.9.1 concat() 함수
### 3.9.2 merge() 함수
### 3.9.3 join() 메서드
## 3.10 데이터 재구조화
### 3.10.1 melt()
### 3.10.2 pivot_table()
### 3.10.3 stack()과 unstack()
## 3.11 데이터프레임에 함수 적용하기
### 3.11.1 시리즈에 함수 적용하기
### 3.11.2 데이터프레임에 함수 적용하기
## 3.12 그룹 연산하기
### 3.12.1 그룹 나누기
### 3.12.2 그룹별 연산하기
## 3.13 시계열 데이터 다루기
### 3.13.1 시계열 데이터 만들기